@{
    ViewData["Title"] = "Register";
}

@model SignUpViewModel

<style>
    .password-strength {
        margin-top: 5px;
        font-size: 0.875rem;
        display: flex;
        visibility: hidden;
    }

    .password-strength span {
        display: inline-block;
        width: 20%;
        height: 5px;
        background-color: #e0e0e0;
        margin-right: 2px;
    }

    .password-strength .strength-weak {
        background-color: #c34040;
    }

    .password-strength .strength-medium {
        background-color: #d3d334;
    }

    .password-strength .strength-strong {
        background-color: #34ba34;
    }
</style>
<div class="container mt-5">
    <div class="hero text-center">
        <h2>Welcome to Our Car Rental Service!</h2>
        <p>Please fill out the form below to create your account and start booking cars easily.</p>
    </div>

    <form asp-action="SignUp" method="post">
        <div asp-validation-summary="ModelOnly" class="alert alert-danger" role="alert"></div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <label asp-for="FirstName">First Name</label>
                    <input asp-for="FirstName" class="form-control"/>
                    <span asp-validation-for="FirstName" class="text-danger"></span>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <label asp-for="LastName">Last Name</label>
                    <input asp-for="LastName" class="form-control"/>
                    <span asp-validation-for="LastName" class="text-danger"></span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 mb-3">
                <div class="form-group">
                    <label asp-for="UserName">Username</label>
                    <input asp-for="UserName" class="form-control"/>
                    <small class="form-text text-muted">Your unique username to display on your profile.</small>
                    <div class="text-danger">
                        <span asp-validation-for="UserName"></span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <label asp-for="Email">Email</label>
                    <input asp-for="Email" class="form-control" type="email"/>
                    <small class="form-text text-muted">We'll never share your email with anyone else.</small>
                    <div class="text-danger">
                        <span asp-validation-for="Email"></span>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <label asp-for="PhoneNumber">Phone Number</label>
                    <input asp-for="PhoneNumber" class="form-control"/>
                    <span asp-validation-for="PhoneNumber" class="text-danger"></span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <label asp-for="Password">Password</label>
                    <input asp-for="Password" class="form-control" type="password" id="password"/>
                    <span asp-validation-for="Password" class="text-danger"></span>
                    <div id="password-strength" class="password-strength">
                        <span></span><span></span><span></span><span></span><span></span>
                    </div>
                </div>
            </div>
            <div class="col-md-6 mb-3">
                <div class="form-group">
                    <label asp-for="ConfirmPassword">Confirm Password</label>
                    <input asp-for="ConfirmPassword" class="form-control" type="password"/>
                    <span asp-validation-for="ConfirmPassword" class="text-danger"></span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 mb-3">
                <div class="form-group">
                    <label asp-for="DateOfBirth">Date of Birth</label>
                    <input asp-for="DateOfBirth" class="form-control" type="date"/>
                    <span asp-validation-for="DateOfBirth" class="text-danger"></span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 mb-3">
                <div class="form-group">
                    <label asp-for="DriversLicenseNumber">Driver's License Number</label>
                    <input asp-for="DriversLicenseNumber" class="form-control"/>
                    <span asp-validation-for="DriversLicenseNumber" class="text-danger"></span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 mb-3">
                <div class="form-group">
                    <label asp-for="AddressLine1">Address Line 1</label>
                    <input asp-for="AddressLine1" class="form-control"/>
                    <span asp-validation-for="AddressLine1" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="AddressLine2">Address Line 2</label>
                    <input asp-for="AddressLine2" class="form-control"/>
                    <span asp-validation-for="AddressLine2" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="City">City</label>
                    <input asp-for="City" class="form-control"/>
                    <span asp-validation-for="City" class="text-danger"></span>
                </div>
                <div class="form-group">
                    <label asp-for="Country"></label>
                    <select asp-for="Country" class="form-control"
                            asp-items="@(new SelectList(ViewData["Countries"] as List<string>))">
                        <option value="">Select a country</option>
                    </select>
                    <span asp-validation-for="Country" class="text-danger"></span>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12 text-center mb-3">
                <button type="submit" class="btn btn-primary">Register</button>
            </div>
        </div>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial"/>
    <script>
    $(document).ready(function () {
        $.validator.addMethod("passwordStrength", function (value, element) {
            return this.optional(element) || /[A-Z]/.test(value) && /[a-z]/.test(value) && /\d/.test(value) && /\W/.test(value);
        }, "Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character.");

        $("#password").rules("add", {
            required: true,
            minlength: 6,
            passwordStrength: true,
            messages: {
                required: "Password is required.",
                minlength: "Password must be at least 6 characters long.",
                passwordStrength: "Password must contain at least one uppercase letter, one lowercase letter, one number, and one special character."
            }
        });

        $('#password').on('input', function () {
            const password = $(this).val();
            let strength = 0;
            const passwordStrength = $('#password-strength');

            if (password.length > 0) {
                passwordStrength.css('visibility', 'visible');
            } else {
                passwordStrength.css('visibility', 'hidden');
            }

            if (password.length >= 6) strength++;
            if (/[A-Z]/.test(password)) strength++;
            if (/[a-z]/.test(password)) strength++;
            if (/\d/.test(password)) strength++;
            if (/\W/.test(password)) strength++;

            const spans = passwordStrength.find('span');
            spans.removeClass('strength-weak strength-medium strength-strong');
            for (let i = 0; i < strength; i++) {
                if (strength <= 2) {
                    spans.eq(i).addClass('strength-weak');
                } else if (strength <= 4) {
                    spans.eq(i).addClass('strength-medium');
                } else {
                    spans.eq(i).addClass('strength-strong');
                }
            }
        });
    });
</script>
}